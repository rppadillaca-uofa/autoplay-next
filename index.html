<!doctype html>
<html lang="en">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Autoplay Next</title>
<style>
  html,body{margin:0;height:100%;background:#000;overflow:hidden}
  #stage{position:fixed;inset:0;display:grid;place-items:center}
  video{width:100%;height:100%;object-fit:cover}
  .slide{animation:slideIn 320ms ease}
  @keyframes slideIn{from{transform:translateY(100%)}to{transform:translateY(0)}}

  #start{
    position:fixed;inset:0;display:grid;place-items:center;
    background:#000;color:#fff;font:600 18px system-ui;letter-spacing:.2px;cursor:pointer
  }

  /* Feed-style UI */
  #ui{
    position:fixed;right:12px;bottom:88px;display:flex;flex-direction:column;gap:16px;
    z-index:3
  }
  .btn{
    width:52px;height:52px;border-radius:999px;display:grid;place-items:center;
    background:rgba(0,0,0,.35);backdrop-filter:blur(2px);cursor:pointer
  }
  .btn svg{width:26px;height:26px;fill:#fff;transition:fill 0.2s ease}
  .btn.liked svg{fill:#ff3b30}
  .count{
    color:#fff;text-align:center;font:600 12px/1 system-ui;margin-top:2px;opacity:.9
  }

  #caption{
    position:fixed;left:0;right:0;bottom:0;padding:16px;color:#fff;z-index:2;
    background:linear-gradient(0deg,rgba(0,0,0,.72),rgba(0,0,0,0));
    font:500 14px/1.4 system-ui
  }
  #meta{
    position:fixed;left:12px;bottom:108px;color:#fff;z-index:2;
    font:600 13px/1 system-ui;opacity:.95;text-shadow:0 1px 2px rgba(0,0,0,.5)
  }
</style>

<div id="stage">
  <video id="v" playsinline muted preload="auto" x-webkit-airplay="deny"></video>
</div>

<!-- UI -->
<div id="ui">
  <div class="btn" id="likeBtn">
  <!-- heart -->
  <svg viewBox="0 0 48 48">
    <path d="M34.6 6c-4.2 0-7.9 2.1-10.6 5.4C21.3 8.1 17.6 6 13.4 6 7.6 6 3 10.6 3 16.4c0 11.1 19 22.5 19 22.5s19-11.4 19-22.5C41 10.6 36.4 6 30.6 6z"/>
  </svg>
</div>

  <div class="btn">
    <!-- comment -->
    <svg viewBox="0 0 24 24"><path d="M21 6.5a3.5 3.5 0 0 0-3.5-3.5h-11A3.5 3.5 0 0 0 3 6.5v6A3.5 3.5 0 0 0 6.5 16H8v3l3-3h6.5A3.5 3.5 0 0 0 21 12.5v-6z"/></svg>
  </div>
  <div class="count"> </div>

  <div class="btn">
    <!-- share -->
    <svg viewBox="0 0 24 24"><path d="M18 8a3 3 0 1 0-2.82-4H15a3 3 0 0 0 .18 1.02L7.91 9.2A3 3 0 0 0 6 8.5a3 3 0 1 0 1.95 5.25l7.18 4.15A3 3 0 1 0 16 20a3 3 0 0 0-.18-1.02l-7.18-4.15A3 3 0 0 0 9 12.5c0-.22-.02-.44-.07-.64l7.16-4.13c.26.17.56.28.88.34A3 3 0 0 0 18 8z"/></svg>
  </div>
  <div class="count"> </div>
</div>

<div id="meta">@autoplay.next</div>
<div id="caption" role="status" aria-live="polite"></div>

<div id="start">Tap to begin</div>

<script>
  const CUT = 27_000;
  const clips = [
    {src:"https://dl.dropboxusercontent.com/scl/fi/ci3jsb6eor610xxgnkk14/01-rewrite.mp4.mp4?rlkey=2hodyoqum98fkz5a7txafcbt0&st=zxc2h67u", caption:"Rewrite"},
    {src:"https://dl.dropboxusercontent.com/scl/fi/tbrm6pgpbnl3d7xlka603/02-loud-thoughts.mp4.mp4?rlkey=fse205d4h2gktepzvxyz6zqis&st=5mh9rfqu", caption:"Loud Thoughts"},
    {src:"https://dl.dropboxusercontent.com/scl/fi/4vteqjcawowjz5d10h9m1/03-cheapest-apocalypse.mp4.mp4?rlkey=pwvavyfzuczwdtdnq7oz0unql&st=73pv0v5e", caption:"The Cheapest Apocalypse"},
    {src:"https://dl.dropboxusercontent.com/scl/fi/dvzq0iwf9ghqjxl15bnkp/04-swap.mp4.mp4?rlkey=n5qnk364v9noz3odtk89z0uu4&st=rzyghn3b", caption:"Swap"},
    {src:"https://dl.dropboxusercontent.com/scl/fi/gx0hb5ds6lhr7w80n07yl/05-chapter-13.mp4.mp4?rlkey=60mqoii3qgzmbhw1ftm615g8q&st=n7wp4drl", caption:"Chapter 13"},
  ];

  const v = document.getElementById('v');
  const start = document.getElementById('start');
  const caption = document.getElementById('caption');
  const likeBtn = document.getElementById('likeBtn');

  let i = 0, timer = null;

  // prevent scroll
  const block = e => e.preventDefault();
  ['touchmove','wheel','gesturestart'].forEach(evt=>{
    window.addEventListener(evt, block, {passive:false});
  });

  // video flow
  function setClip(idx){
    i = idx % clips.length;
    v.classList.remove('slide');
    v.src = clips[i].src;
    v.load();
    v.onloadeddata = ()=>{
      v.classList.add('slide');
      v.currentTime = 0;
      v.play().catch(()=>{});
      caption.textContent = clips[i].caption;
      clearTimeout(timer);
      timer = setTimeout(nextClip, CUT);
    };
  }
  function nextClip(){ setClip(i+1); }

  document.addEventListener('visibilitychange', ()=>{
    if(!document.hidden) v.play().catch(()=>{});
  });

  start.addEventListener('click', ()=>{
    start.style.display='none';
    setClip(0);
  });

  // like toggle
  likeBtn.addEventListener('click', ()=>{
    likeBtn.classList.toggle('liked');
  });
</script>
</html>

